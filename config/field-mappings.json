{
  "comment": "Maps Shopify products.json format to YogaMat schema. All measurements stored in metric units (mm, cm, kg).",
  "requiredFields": {
    "brandId": {
      "description": "Convex brand ID - resolved by looking up brand slug",
      "type": "string"
    },
    "name": {
      "source": "title",
      "type": "string",
      "description": "Product title from Shopify"
    },
    "slug": {
      "source": "handle",
      "type": "string",
      "description": "URL-safe slug from Shopify handle"
    },
    "minPrice": {
      "source": "variants[].price",
      "type": "number",
      "description": "Minimum price across all variants",
      "transform": "Math.min"
    }
  },
  "optionalFields": {
    "description": {
      "source": "body_html",
      "type": "string",
      "description": "HTML description from Shopify",
      "transform": "stripHtml"
    },
    "shopifyId": {
      "source": "id",
      "type": "number",
      "description": "Original Shopify product ID"
    },
    "shopifyHandle": {
      "source": "handle",
      "type": "string",
      "description": "Original Shopify handle"
    },
    "shopifyTags": {
      "source": "tags",
      "type": "array",
      "description": "Shopify tags for features/materials extraction"
    },
    "shopifyOptions": {
      "source": "options",
      "type": "array",
      "description": "Product options (color, size, thickness, etc.) - PRIORITY source for dimensions and colors"
    },
    "images": {
      "source": "images",
      "type": "array",
      "description": "Product images array with src, alt, width, height, position"
    },
    "minPrice": {
      "computed": true,
      "description": "Minimum price across all variants (USD)"
    },
    "maxPrice": {
      "computed": true,
      "description": "Maximum price across all variants (USD)"
    },
    "minGrams": {
      "computed": true,
      "description": "Minimum weight in grams from variants"
    },
    "maxGrams": {
      "computed": true,
      "description": "Maximum weight in grams from variants"
    },
    "isAvailable": {
      "computed": true,
      "description": "True if any variant is available for purchase"
    }
  },
  "extractionPriority": {
    "description": "Extraction follows this priority order: options FIRST, then description/tags as fallback",
    "order": ["options", "description", "tags"]
  },
  "extractFromOptions": {
    "thickness": {
      "optionNames": ["size", "thickness"],
      "patterns": [
        "(\\d+(?:\\.\\d+)?)\\s*mm",
        "^(\\d+(?:\\.\\d+)?)$"
      ],
      "unit": "mm",
      "description": "Extract from options like 'Size: 5 MM' or 'Thickness: 8 MM'"
    },
    "dimensions": {
      "optionNames": ["size", "dimensions", "dimension"],
      "patterns": [
        "(\\d+(?:\\.\\d+)?)\\s*(?:inch|\"|cm)?\\s*[xX×]\\s*(\\d+(?:\\.\\d+)?)\\s*(?:inch|\"|cm)?"
      ],
      "units": "cm",
      "description": "Extract from options like 'Size: 72\" x 26\"' or 'Size: 80\" x 26\"'"
    },
    "colors": {
      "optionNames": ["color", "colour", "color/pattern"],
      "description": "Extract color options directly from values"
    }
  },
  "extractFromDescription": {
    "thickness": {
      "patterns": [
        "(\\d+(?:\\.\\d+)?)\\s*mm",
        "(\\d+(?:\\.\\d+)?)\\s*millimeter",
        "(\\d+(?:\\.\\d+)?)\\s*inch(?:es)?",
        "(\\d+/\\d+)\\s*inch"
      ],
      "unit": "mm",
      "description": "Fallback: Extract thickness from description with unit conversion"
    },
    "length": {
      "patterns": [
        "(\\d+(?:\\.\\d+)?)\\s*inch(?:es)?\\s*(?:long|length|L)",
        "(\\d+(?:\\.\\d+)?)\\s*cm\\s*(?:long|length|L)",
        "(\\d+)\"\\s*[xX×]"
      ],
      "unit": "cm",
      "description": "Fallback: Extract length (converted to cm)"
    },
    "width": {
      "patterns": [
        "[xX×]\\s*(\\d+(?:\\.\\d+)?)\\s*inch(?:es)?",
        "[xX×]\\s*(\\d+(?:\\.\\d+)?)\\s*cm",
        "[xX×]\\s*(\\d+)\""
      ],
      "unit": "cm",
      "description": "Fallback: Extract width (converted to cm)"
    },
    "weight": {
      "patterns": [
        "(\\d+(?:\\.\\d+)?)\\s*kg",
        "(\\d+(?:\\.\\d+)?)\\s*(?:lbs?|pounds?)",
        "(\\d+)\\s*grams"
      ],
      "unit": "kg",
      "description": "Fallback: Extract weight from description (converted to kg)"
    },
    "material": {
      "keywords": [
        "PVC",
        "TPE",
        "Natural Rubber",
        "Cork",
        "Jute",
        "Cotton",
        "Polyurethane",
        "PU",
        "EVA",
        "NBR"
      ],
      "description": "Extract material type from description/tags"
    },
    "features": {
      "keywords": {
        "Eco-Friendly": ["eco", "sustainable", "planet friendly", "recycled", "biodegradable"],
        "Reversible": ["reversible", "two-sided", "dual-sided"],
        "Extra Thick": ["extra thick", "cushioned", "plush"],
        "Non-Slip": ["non-slip", "non slip", "grippy", "grip"],
        "Lightweight": ["lightweight", "light weight", "travel", "portable"],
        "Extra Long": ["extra long", "long", "tall"],
        "Extra Wide": ["extra wide", "wide"],
        "Alignment Marks": ["alignment", "alignment marks", "markers", "guide"],
        "Antimicrobial": ["antimicrobial", "antibacterial", "hygienic"],
        "Closed-Cell": ["closed-cell", "closed cell", "moisture resistant"]
      },
      "description": "Extract features from description and tags"
    }
  },
  "defaults": {
    "thickness": 5,
    "length": 172.72,
    "width": 60.96,
    "gripDry": 5,
    "gripWet": 5,
    "cushioning": 5,
    "durability": 5,
    "ecoRating": 5,
    "description": "Yoga mat"
  },
  "unitConversions": {
    "thickness": {
      "mm_to_mm": 1,
      "cm_to_mm": 10,
      "inch_to_mm": 25.4
    },
    "length": {
      "cm_to_cm": 1,
      "inch_to_cm": 2.54,
      "mm_to_cm": 0.1
    },
    "width": {
      "cm_to_cm": 1,
      "inch_to_cm": 2.54,
      "mm_to_cm": 0.1
    },
    "weight": {
      "kg_to_kg": 1,
      "lbs_to_kg": 0.453592,
      "oz_to_kg": 0.0283495,
      "g_to_kg": 0.001
    }
  }
}
